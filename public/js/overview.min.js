function check_password_strength(e){if("undefined"!=typeof zxcvbn)return["very weak","weak","medium","strong","very strong"][zxcvbn(e).score]||"calc not available";console.error("zxcvbn library not loaded")}$(document).ready(function(){if(null===sessionStorage.getItem("visited")){const e=$(".welcome-gif-wrapper");e.css("visibility","visible"),e.fadeIn(200),setTimeout(()=>{e.fadeOut(200),setTimeout(()=>e.hide(),200)},2210),sessionStorage.setItem("visited","true")}let a={password:"",show:!0};$(".entries").click(function(){var e=$(this).attr("data-id"),t=($("#clear-details").show(),$("#copy-to-clipboard").show(),$("#show-password").show(),$("#details-edit").show(),$("#trash-form").show(),$("#favorite-form").show(),new URL(window.location)),t=new URLSearchParams(t.search);let s="/ajax/ajax.php?getPass="+e;t.has("mode")&&(e="&mode="+t.get("mode"),s+=e),fetch(s).then(e=>e.ok?e.json():Promise.reject()).then(e=>{$("#details-website-link").text(e.website),e.website.includes("http://")||e.website.includes("https://")?$("#details-website-link").prop("href",e.website):$("#details-website-link").prop("href","http://"+e.website),$("#details-username").text(e.username),$("#details-password").text("*********"),$("input.entryId").val(e.id),a.password=e.password,a.show=!1,$("#copy-to-clipboard").off("click").on("click",function(){navigator.clipboard.writeText(a.password).then(()=>{}).catch(e=>{})})}).catch(()=>{$("#details-error").text("Error during details gathering")})}),$("#search").on("input",function(){var e=$(this).val();$.ajax({url:"/ajax/ajax.php",type:"POST",data:{query:e},success:function(e){console.log(e),$(".overview-passwords-listing").html(e)},error:function(){}})}),$("#clear-details").click(function(){$("#details-website-link").text(""),$("#details-username").text(""),$("#details-password").text(""),$("#clear-details").hide(),$("#copy-to-clipboard").hide(),$("#show-password").hide(),$("#details-edit").hide(),$("#trash-form").hide(),$("#favorite-form").hide(),$("#details-error").text("")}),$("#show-password").click(function(){a.show?($("#details-password").text("*********"),a.show=!1):($("#details-password").text(a.password),a.show=!0)}),$("#details-edit").click(function(){document.getElementById("edit-modal").showModal(),$("#edit_website").val($("#details-website-link").text()),$("#edit_username").val($("#details-username").text())}),$("#edit-change").click(function(){""!==$("#edit_website, #edit_username, #edit_password").val()?$.ajax({type:"POST",url:"/ajax/edit-password.php",data:{edit_id:$("#edit_id").val(),edit_website:$("#edit_website").val(),edit_username:$("#edit_username").val(),edit_password:$("#edit_password").val()},dataType:"json",success:function(e){e.success||e.redirect?window.location.href=e.redirect:$("#edit-errorMsg").text(e.error)},error:function(e,t,s){0===e.status?$("#edit-errorMsg").text("Unable to connect. Please check your internet connection."):404===e.status?$("#edit-errorMsg").text("The requested page was not found."):$("#edit-errorMsg").text("An error occurred during the data transmission.\nPlease try again later.")}}):$("#edit-errorMsg").text("Please fill in all the required fields.")}),$("#edit-cancel").click(function(){document.getElementById("edit-modal").close()}),$("#settings").click(function(){document.getElementById("settings-modal").showModal()}),$("#settings-change").click(function(){""!==$("#newUsername").val()?$.ajax({type:"POST",url:"/ajax/account-settings.php",data:{newUsername:$("#newUsername").val()},dataType:"json",success:function(e){e.success||e.redirect?window.location.href=e.redirect:$("#settings-errorMsg").text(e.error)},error:function(e,t,s){0===e.status?$("#settings-errorMsg").text("Unable to connect. Please check your internet connection."):404===e.status?$("#settings-errorMsg").text("The requested page was not found."):$("#settings-errorMsg").text("An error occurred during the data transmission.\nPlease try again later.")}}):""!==$("#oldPassword, #newPassword").val()?$.ajax({type:"POST",url:"/ajax/account-settings.php",data:{oldPassword:$("#oldPassword").val(),newPassword:$("#newPassword").val()},dataType:"json",success:function(e){e.success||e.redirect?window.location.href=e.redirect:$("#settings-errorMsg").text(e.error)},error:function(e,t,s){0===e.status?$("#settings-errorMsg").text("Unable to connect. Please check your internet connection."):404===e.status?$("#settings-errorMsg").text("The requested page was not found."):$("#settings-errorMsg").text("An error occurred during the data transmission.\nPlease try again later.")}}):$("#settings-errorMsg").text("Please fill in all the required fields.")}),$("#settings-cancel").click(function(){document.getElementById("settings-modal").close()}),$(".settings-tabs span").click(function(){var e=$(".change-username"),t=$(".change-masterpass");$("span.active").removeClass("active"),$(this).addClass("active"),($(this)[0].classList.contains("settings-username")?(t.hide(),$("#oldPassword").val(""),$("#newPassword").val(""),e):(e.hide(),$("#newUsername").val(""),t)).fadeIn(100)}),$("#add-password").click(function(){document.getElementById("add-modal").showModal()}),$("#add-change").click(function(){""!==$("#add_website, #add_username, #add_password").val()?$.ajax({type:"POST",url:"/ajax/add-password.php",data:{website:$("#add_website").val(),username:$("#add_username").val(),password:$("#add_password").val()},dataType:"json",success:function(e){e.success||e.redirect?window.location.href=e.redirect:$("#add-errorMsg").text(e.error)},error:function(e,t,s){0===e.status?$("#add-errorMsg").text("Unable to connect. Please check your internet connection."):404===e.status?$("#add-errorMsg").text("The requested page was not found."):$("#add-errorMsg").text("An error occurred during the data transmission.\nPlease try again later.")}}):$("#add-errorMsg").text("Please fill in all the required fields.")}),$("#add-cancel").click(function(){document.getElementById("add-modal").close()}),$("dialog").on("click",".toggle-password",function(){$(this).toggleClass("bi-eye bi-eye-slash");var e=$(this).prev("input");"password"===e.attr("type")?e.attr("type","text"):e.attr("type","password")}),$("#gen-password").click(()=>{var e=$(".gen-field");"none"===e.css("display")?e.fadeIn(100):e.fadeOut(100)}),$("#generate").on("click",function(){var e={generate:!0,length:$("#gen-length").val(),digits:$("#gen-digits").is(":checked"),special:$("#gen-special").is(":checked")};""!==$("#gen-length").val()?$.ajax({type:"POST",url:"/ajax/add-password.php",data:e,dataType:"json",success:function(e){e.success&&$("#add_password").val(e.password).trigger("input")},error:function(e,t,s){0===e.status?$("#add-errorMsg").text("Unable to connect. Please check your internet connection."):404===e.status?$("#add-errorMsg").text("The requested page was not found."):$("#add-errorMsg").text("An error occurred during the data transmission.\nPlease try again later.")}}):$("#add-errorMsg").text("Please fill in all the required fields.")});const r=["calc not avaliable","very strong","strong","medium","weak","very weak"],i=["black","lightgreen","green","#fcee59","orange","red","darkred"];$("#add_password").on("input",function(){let e=$("#add_password").val();var t,s;""===e?$("#progressBar").css("display","none"):(t=check_password_strength(e),t=r.indexOf(t),s=i[t],0!==t?(t=100/t,$("#progressBar").css({width:t+"%",backgroundColor:s})):$("#progressBar").css({width:"100%",backgroundColor:"darkred"}),$("#progressBar").css("display","block"))}),document.querySelectorAll("dialog").forEach(s=>{s.addEventListener("click",e=>{var t=s.getBoundingClientRect();(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom&&s.open)&&s.close()})}),$("#sidebar-toggle").on("click",function(){var e=$(".overview-sidebar"),t=$(".overview-sidebar-text");50<e.width()?($(".overview-sidebar").width(50),$(this).find(":first-child").removeClass("bi-arrow-bar-left").addClass("bi-arrow-bar-right"),t.hide()):(e.width(200).css("background",""),$(this).find(":first-child").removeClass("bi-arrow-bar-right").addClass("bi-arrow-bar-left"),t.show())})});